<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Random Game Loader</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    font-family: sans-serif;
    color: white;
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    background: black;
    position: relative;
}

/* Background image inside img for proper blur */
#background img {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 120%;
    height: 120%;
    object-fit: cover;
    transform: translate(-50%, -50%);
    filter: blur(25px);
    z-index: -2;
}

/* Reverse vignette: dark center, edges lighter */
#vignette {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 70%);
    z-index: -1;
}

#content {
    z-index: 1;
    padding: 20px;
}
#title {
    font-size: 3em;
    font-weight: bold;
    margin-bottom: 20px;
}
#countdown {
    font-size: 2em;
    margin-bottom: 40px;
}
#differentGame {
    font-size: 1.2em;
    cursor: pointer;
    text-decoration: underline;
    color: white;
}
</style>
</head>
<body>
<div id="background"><img src="" alt="Background"></div>
<div id="vignette"></div>
<div id="content">
    <div id="title">Loading...</div>
    <div id="countdown"></div>
    <div id="differentGame">Different game</div>
</div>

<script>
let gameLines = [];
let countdown = 5;
let countdownInterval;

(async () => {
    const url = 'https://raw.githubusercontent.com/4texas4/zenith/main/app/play.html';
    const response = await fetch(url);
    const text = await response.text();

    const match = text.match(/const\s+rawGameList\s*=\s*`([\s\S]*?)`;/);
    if (!match) {
        document.getElementById('title').textContent = 'rawGameList not found!';
        return;
    }

    gameLines = match[1].trim().split('\n').filter(line => line.trim().length > 0);
    pickRandomGame();
})();

function pickRandomGame() {
    clearInterval(countdownInterval);
    countdown = 5;

    const randomLine = gameLines[Math.floor(Math.random() * gameLines.length)];
    let [title, imageUrl, url] = randomLine.split(',').map(s => s.trim());

    // Set image src directly
    document.querySelector('#background img').src = imageUrl;

    const titleEl = document.getElementById('title');
    const countdownEl = document.getElementById('countdown');

    titleEl.innerHTML = `<b>${title}</b>`;
    countdownEl.textContent = `Loading in ${countdown}`;

    countdownInterval = setInterval(() => {
        countdown--;
        if (countdown > 0) {
            countdownEl.textContent = `Loading in ${countdown}`;
        } else {
            clearInterval(countdownInterval);
            window.location.href = url;
        }
    }, 1000);
}

document.getElementById('differentGame').addEventListener('click', pickRandomGame);
</script>
</body>
</html>
